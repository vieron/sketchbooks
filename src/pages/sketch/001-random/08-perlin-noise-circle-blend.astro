---
import Sketch from "../../../layouts/Sketch.astro";
---

<Sketch title="003 Line">
  <script>
    import "p5";

    let noiseMax = 0.6; // between 0 and 10
    let phase = 0;
    let zoff = 0;
    let radiusVariation: number;
    let hue = 0;
    let saturation = 0;

    let avgRadius: number;
    let minRadius: number;
    let maxRadius: number;

    window.setup = () => {
      radiusVariation = Math.min(windowWidth, windowHeight) * 0.4;
      avgRadius = Math.min(windowWidth, windowHeight) * 0.3;
      minRadius = avgRadius - radiusVariation * 0.5;
      maxRadius = avgRadius + radiusVariation * 0.5;

      createCanvas(windowWidth, windowHeight);
      colorMode(HSL);
      // frameRate(20);
      background(color("#fff"));
    };

    function drawBlob({
      center = [width / 2, height / 2],
      hue = 0,
      phase = 0,
      zoff = 0,
      radiusRange = [minRadius, maxRadius],
    }) {
      translate(center[0], center[1]);
      // stroke(hue, 90, 50, 0.8);
      stroke(0, 0, 0, 0.15);
      strokeWeight(1);
      noFill();
      beginShape();
      for (let a = 0; a < TWO_PI; a += 0.01) {
        let xoff = map(cos(a + phase), -1, 1, 0, noiseMax);
        let yoff = map(sin(a + phase), -1, 1, 0, noiseMax);
        let r = map(
          noise(xoff, yoff, zoff),
          0,
          1,
          radiusRange[0],
          radiusRange[1]
        );
        let x = r * cos(a);
        let y = r * sin(a);
        vertex(x, y);
      }
      endShape(CLOSE);
    }

    window.draw = () => {
      drawBlob({
        hue,
        radiusRange: [10, 400],
        phase,
        zoff,
      });

      hue += random(20, 100);
      phase += 1;
      zoff += 0.00025;

      if (hue >= 255) {
        hue = 0;
      }
    };
  </script>
</Sketch>
